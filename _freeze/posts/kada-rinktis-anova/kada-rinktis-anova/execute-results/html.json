{
  "hash": "d8a2da52707022f161093e7c4cc856e9",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Kada rinktis ANOVA?\"\ndescription: \"ANOVA galima rinktis tokiu atveju, kai turime 3 arba daugiau kategorijų. Sužinokite, kaip atlikti ir interpretuoti ANOVA testą.\"\ndate: \"2023-04-15\"\nauthor: \"Paulius Alaburda\"\ncategories: [statistika, ANOVA, R]\nimage: kada-rinktis-anova_files/figure-html/unnamed-chunk-8-1.png\neditor: source\ntoc: true\nexecute:\n  warning: false\n  message: false\n---\n\n\n\n# Kaip rinktis ANOVA?\n\n## Kada rinktis ANOVA?\n\nANOVA galima rinktis tokiu atveju, kai turime 3 arba daugiau kategorijų nepriklausomame kintamajame, pagal kurias norime palyginti tolydų priklausomą kintamąjį. Pavyzdžiui, norime palyginti, ar gerklės skausmo lygis skyrėsi priklausomai nuo to, ar buvo atlikta mažos, vidutinės ar didelės apimties operacija. Tokių atvejų pasitaiko dažnai, bet ne kiekvienas žino, ką daryti, jeigu ANOVA rezultatas yra statistiškai reikšmingas.\n\n## Vienpusė ANOVA\n\nVienpusė ANOVA reiškia, jog turime tolydų kintamąjį (ūgį, svorį, amžių) ir jų norime palyginti tarp 3 arba daugiau grupių.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(broom)\nlibrary(car)\nlibrary(dplyr)\nlibrary(ggplot2)\n\nmy.anova <- aov(data = iris, Sepal.Length ~ Species)\nsummary(my.anova)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             Df Sum Sq Mean Sq F value Pr(>F)    \nSpecies       2  63.21  31.606   119.3 <2e-16 ***\nResiduals   147  38.96   0.265                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n::: {.callout-note}\n## Šaltiniai\n[Non-normal data: Is ANOVA still a valid option?](https://pubmed.ncbi.nlm.nih.gov/29048317/)\n:::\n\n# Dvipusė ANOVA\n\nDvipusė ANOVA naudojama, kai norime įvertinti dviejų nepriklausomų kintamųjų poveikį priklausomam kintamajam.\n\n# Post-hoc testai\n\nJeigu mūsų ANOVA rezultatas buvo statistiškai reikšmingas, vis dar nežinome, kuri pora grupių tarpusavyje turėtų statistiškai reikšmingą skirtumą. Tam turime atlikti post-hoc testą, t.y. testą, kuris parenka 2 subgrupes ir konkrečiai jas palygina.\n\nNėra vieno standarto, kaip būtinai reikia atlikti post-hoc testą, bet dažniausias pasirinkimas yra Tukey HSD (Honestly Significant Difference) testas. Su R tai galima atlikti naudojantis `TukeyHSD` funkcija:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTukeyHSD(my.anova)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = Sepal.Length ~ Species, data = iris)\n\n$Species\n                      diff       lwr       upr p adj\nversicolor-setosa    0.930 0.6862273 1.1737727     0\nvirginica-setosa     1.582 1.3382273 1.8257727     0\nvirginica-versicolor 0.652 0.4082273 0.8957727     0\n```\n\n\n:::\n:::\n\n\n\nPost-hoc testas nurodo, jog skirtumai buvo tarp visų 3 rūšių tarpusavyje, didžiausias skirtumas buvo tarp virginica ir setosa (vidutiniškai 1,58, 95% PI [1,34-1,83], p < 0,001).\n\n# 3 vienpusės ANOVA poskoniai\n\nKai mūsų duomenų rinkinys yra subalansuotas, visi ANOVA tipai duos tokį patį rezultatą. Kai duomenų rinkinys yra nesubalansuotas (viena grupė turi daugiau matavimų negu kitos), rezultatai gali skirtis.\n\n# Ar ANOVA buvo tinkamas testas?\n\nStjudento t-testo tinkamumą praktiniais sumetimais galime numatyti iš anksto, nors teisingas būdas tikrinti būtų toks kaip ir ANOVA atveju. ANOVA turi tris reikalavimus:\n\n-   **Likutinių verčių (paklaidų) pasiskirstymas turi būti pagal Normalųjį skirstinį**. Mažai kas tai tikrina iš tikrųjų ir dažniausiai naudoja histogramas (ok), QQ grafikus (gerai) arba Shapiro-Wilk testą (blogai!)\n-   **Homogeniška variacija** tarp grupių\n-   **Nepriklausomi stebėjimai**\n\n## Homogeniška variacija\n\nHomogenišką variaciją galima patikrinti su **Levene testu**, **Brown-Forsythe testu** arba **Bartlett testu**, mes panaudosime Levene testą:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nleveneTest(my.anova)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLevene's Test for Homogeneity of Variance (center = median)\n       Df F value   Pr(>F)   \ngroup   2  6.3527 0.002259 **\n      147                    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n## Pasiskirstymas pagal normalųjį skirstinį\n\nPrieš tikrindami, ar mūsų likutinės reikšmės (nepaaiškinta variacija ANOVA modelio) pasiskirsto pagal normalųjį skirstinį, turime iš ANOVA modelio jas išsitraukti, o tada vizualizuoti arba tikrinti su Shapiro-Wilk testu.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy.anova.residuals <- data.frame(residuals = residuals(object = my.anova))\n```\n:::\n\n\n\n::: panel-tabset\n## Histograma\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(my.anova.residuals, aes(sample = residuals)) + \n  stat_qq() + \n  stat_qq_line(color = \"red\")\n```\n\n::: {.cell-output-display}\n![](kada-rinktis-anova_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n## QQ grafikas\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(my.anova.residuals, aes(x = residuals)) + \n  geom_histogram(aes(y = ..density..)) + \n  stat_function(\n    fun = dnorm, color = \"red\",\n    args = with(my.anova.residuals, c(mean = mean(residuals), sd = sd(residuals)))\n  )\n```\n\n::: {.cell-output-display}\n![](kada-rinktis-anova_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n## Shapiro-Wilk testas\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(my.anova.residuals$residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  my.anova.residuals$residuals\nW = 0.9879, p-value = 0.2189\n```\n\n\n:::\n:::\n\n\n:::\n\n::: {.callout-warning}\n## Dėmesio\nShapiro-Wilk testas yra pernelyg jautrus dideliems duomenų rinkiniams. Geriau naudoti vizualinius metodus!\n:::\n\n# Kaip pavaizduoti ANOVA rezultatą?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(iris, aes(x = Species, y = Sepal.Length, fill = Species)) +\n  geom_boxplot() +\n  labs(\n    title = \"Taurėlapių ilgio palyginimas tarp 3 vilkdalgių rūšių\",\n    x = \"Rūšis\",\n    y = \"Taurėlapio ilgis (cm)\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](kada-rinktis-anova_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "kada-rinktis-anova_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}