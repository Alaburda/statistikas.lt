{
  "hash": "741df4125512dbc11f956d9e74956350",
  "result": {
    "markdown": "---\ntitle: \"Kada rinktis ANOVA?\"\neditor: source\ntoc: true\nexecute:\n  warning: false\n  message: false\nimage: images/boxplot_example.png\n---\n\n\n# Kaip rinktis ANOVA?\n\n## Kada rinktis ANOVA?\n\nANOVA galima rinktis tokiu atveju, kai turime 3 arba daugiau kategorijų nepriklausomame kintamajame, pagal kurias norime palyginti tolydų priklausomą kintamąjį. Pavyzdžiui, norime palyginti, ar gerklės skausmo lygis skyrėsi priklausomai nuo to, ar buvo atlikta mažos, vidutinės ar didelės apimties operacija. Tokių atvejų pasitaiko dažnai, bet ne kiekvienas žino, ką daryti, jeigu ANOVA rezultatas yra statistiškai reikšmingas.\n\nANOVA prielaidų tikrinimas\n\n## Vienpusė ANOVA\n\nVienpusė ANOVA reiškia, jog turime tolydų kintamąjį (ūgį, svorį, amžių) ir jų norime palyginti tarp 3 arba daugiau grupių.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(broom)\nlibrary(car)\nlibrary(dplyr)\nlibrary(ggplot2)\n\nmy.anova <- aov(data = iris, Sepal.Length ~ Species)\n\n#my.anova <- iris %>% \n#  lm(data = ., Sepal.Length ~ Species) %>% \n#  Anova(type = 3)\n```\n:::\n\n\nŠaltiniai:\n\n[Non-normal data: Is ANOVA still a valid option?](https://pubmed.ncbi.nlm.nih.gov/29048317/)\n\n# Dvipusė ANOVA\n\n# Post-hoc testai\n\nJeigu mūsų ANOVA rezultatas buvo statistiškai reikšmingas, vis dar nežinome, kuri pora grupių tarpusavyje turėtų statistiškai reikšmingą skirtumą. Tam turime atlikti post-hoc testą, t.y. testą, kuris parenka 2 subgrupes ir konkrečiai jas palygina.\n\nNėra vieno standarto, kaip būtinai reikia atlikti post-hoc testą, bet dažniausias pasirinkimas yra Tukey HSD (Honestly Significant Difference) testas. Su R tai galima atlikti naudojantis `TukeyHSD` funkcija:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTukeyHSD(my.anova)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = Sepal.Length ~ Species, data = iris)\n\n$Species\n                      diff       lwr       upr p adj\nversicolor-setosa    0.930 0.6862273 1.1737727     0\nvirginica-setosa     1.582 1.3382273 1.8257727     0\nvirginica-versicolor 0.652 0.4082273 0.8957727     0\n```\n:::\n:::\n\n\nPost-hoc testas nurodo, jog skirtumai buvo tarp visų 3 rūšių tarpusavyje, didžiausias skirtumas buvo tarp virginica ir setosa (vidutiniškai 1,58, 95% PI \\[1,34-1,83\\], p \\< 0,001).\n\n# 3 vienpusės ANOVA poskoniai\n\nKai mūsų duomenų rinkinys yra subalansuotas, visi ANOVA tipai duos tokį patį rezultatą. Kai duomenų rinkinys yra nesubalansuotas (viena grupė turi daugiau matavimų negu kitos)\n\n# Ar ANOVA buvo tinkamas testas?\n\nStjudento t-testo tinkamumą praktiniais sumetimais galime numatyti iš anksto, nors teisingas būdas tikrinti būtų toks kaip ir ANOVA atveju. ANOVA turi tris reikalavimus:\n\n-   **Likutinių verčių (paklaidų) pasiskirstymas turi būti pagal Normalųjį skirstinį**. Mažai kas tai tikrina iš tikrųjų ir dažniausiai naudoja histogramas (ok), QQ grafikus (gerai) arba Shapiro-Wilk testą (blogai!)\n\n-   **Variacija turi būti homogeniška**. ANOVA daro prielaidą, jog visos 3 grupės turi panašią visos populiacijos variaciją.\n\n-   **Nepriklausomi matavimai**. Kaip ir Stjudento t-testo atveju, individualūs matavimai neturi būti kaip nors susiję.\n\n## Homogeniška variacija\n\nHomogenišką variaciją galima patikrinti su **Levene testu**, **Brown-Forsythe testu** arba **Bartlett testu**, mes panaudosime Levene testą. Levene testas yra paprastas tuo, jog jis atlieka panašų testą kaip ANOVA, bet ne su priklausomu kintamuoju, o su absoliučiu nuokrypiu nuo grupės vidurkio. Levene testą su R galima atlikti taip (atsiprašau, Excel vartotojai!):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nleveneTest(my.anova)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLevene's Test for Homogeneity of Variance (center = median)\n       Df F value   Pr(>F)   \ngroup   2  6.3527 0.002259 **\n      147                    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nLevene testas rodo, jog mes sulaužėme homogeniškos variacijos prielaidą ir tokiu būdu didiname klaidingai teigiamo rezultato tikimybę.\n\n## Pasiskirstymas pagal normalųjį skirstinį\n\nPrieš tikrindami, ar mūsų likutinės reikšmės (nepaaiškinta variacija ANOVA modelio) pasiskirsto pagal normalųjį skirstinį, turime iš ANOVA modelio jas išsitraukti, o tada vizualizuoti arba tikrinti su Shapiro-Wilk testu.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy.anova.residuals <- data.frame(residuals = residuals(object = my.anova))\n```\n:::\n\n\n::: panel-tabset\n## Histograma\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(my.anova.residuals, aes(sample = residuals)) + stat_qq() + stat_qq_line(color = \"red\")\n```\n\n::: {.cell-output-display}\n![](kada-rinktis-anova_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n## QQ grafikas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(my.anova.residuals, aes(x = residuals)) + geom_histogram(aes(y = ..density..)) + stat_function(\n\n\t\tfun = dnorm, color = \"red\",\n\n\t\targs = with(my.anova.residuals, c(mean = mean(residuals), sd = sd(residuals)))\n\n\t)\n```\n\n::: {.cell-output-display}\n![](kada-rinktis-anova_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n## Shapiro-Wilk testas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(my.anova.residuals$residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  my.anova.residuals$residuals\nW = 0.9879, p-value = 0.2189\n```\n:::\n:::\n\n:::\n\nDeja, atitikmens Excel atveju nėra!\n\n\n# Kaip pavaizduoti ANOVA rezultatą?\n\nTinkamiausias būdas vizualizuoti ANOVA rezultatą yra su stačiakampe diagrama:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(iris, aes(x = Species, y = Sepal.Length)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](kada-rinktis-anova_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "kada-rinktis-anova_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}